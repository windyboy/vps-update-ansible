---
- name: Verify
  hosts: all
  become: true
  gather_facts: true

  tasks:
    - name: Check if package cache was updated (Debian/Ubuntu)
      ansible.builtin.stat:
        path: /var/lib/apt/lists
      register: apt_cache
      when: ansible_facts.os_family == "Debian"

    - name: Verify apt cache exists
      ansible.builtin.assert:
        that:
          - apt_cache.stat.exists
        fail_msg: "APT cache does not exist"
        success_msg: "APT cache exists"
      when: ansible_facts.os_family == "Debian"

    - name: Verify system is accessible after updates
      ansible.builtin.command: uptime
      register: uptime_result
      changed_when: false

    - name: Display uptime
      ansible.builtin.debug:
        msg: "System uptime: {{ uptime_result.stdout }}"
